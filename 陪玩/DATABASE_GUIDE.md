# ğŸ“Š SQLite æ•°æ®åº“ç®¡ç†æŒ‡å—

## ğŸ” å¿«é€ŸæŸ¥çœ‹æ•°æ®åº“

### æ–¹æ³• 1ï¼šå¿«é€Ÿä¿¡æ¯è§†å›¾
```bash
node db-info.js
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          ğŸ“Š æ•°æ®åº“ä¿¡æ¯å¿«é€ŸæŸ¥çœ‹                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ˆ ç»Ÿè®¡ä¿¡æ¯ï¼š
   æ€»è®¢å•æ•°ï¼š32
   æ€»æ”¶å…¥ï¼šRM 1569
   å¹³å‡å•ä»·ï¼šRM 49.03

ğŸ’¾ æ•°æ®åº“æ–‡ä»¶ï¼šdata.db (24.60 KB)

ğŸ“‹ æœ€è¿‘ 5 æ¡è®¢å•ï¼š
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   [1] ID:70 | ç©å®¶:è±†è±† | è€æ¿:Jerry
       ç±»å‹:æ°¸åŠ« | é‡‘é¢:RM30 | æ—¥æœŸ:2025/12/15 03:46:07
   [2] ID:69 | ç©å®¶:å°ç¾ | è€æ¿:å¼ ä¸‰
       ...
```

### æ–¹æ³• 2ï¼šäº¤äº’å¼æ•°æ®åº“ç®¡ç†
```bash
node db-manager.js
```

ç„¶åé€‰æ‹©ä½ æƒ³è¦çš„æ“ä½œï¼š
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     ğŸ“Š SQLite æ•°æ®åº“ç®¡ç†å·¥å…·              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

å¯ç”¨å‘½ä»¤ï¼š
  1. æŸ¥çœ‹æ‰€æœ‰è®¢å•
  2. æŸ¥çœ‹ç»Ÿè®¡æ•°æ®
  3. æŸ¥çœ‹æœ€è¿‘ N æ¡è®¢å•
  4. æŒ‰ ID æŸ¥çœ‹è®¢å•è¯¦æƒ…
  5. æœç´¢è®¢å•ï¼ˆæŒ‰ç©å®¶åç§°ï¼‰
  6. å¯¼å‡ºè®¢å•ä¸º JSON
  7. å¯¼å‡ºè®¢å•ä¸º CSV
  8. æ¸…ç©ºæ‰€æœ‰è®¢å•ï¼ˆè­¦å‘Šï¼ï¼‰
  9. é‡ç½®ç»Ÿè®¡æ•°æ®
  0. é€€å‡º
```

## ğŸ“‹ æ•°æ®åº“ç®¡ç†å·¥å…·è¯¦è§£

### db-manager.js - å®Œæ•´çš„æ•°æ®åº“ç®¡ç†å·¥å…·

#### äº¤äº’å¼ä½¿ç”¨
```bash
node db-manager.js
```

#### å‘½ä»¤è¡Œä½¿ç”¨ï¼ˆå¿«é€Ÿå‘½ä»¤ï¼‰

**æŸ¥çœ‹æ‰€æœ‰è®¢å•ï¼š**
```bash
node db-manager.js view
```

**æŸ¥çœ‹ç»Ÿè®¡æ•°æ®ï¼š**
```bash
node db-manager.js stats
```

**æŸ¥çœ‹æœ€è¿‘ N æ¡è®¢å•ï¼š**
```bash
node db-manager.js recent 20
```

**æŒ‰ ID æŸ¥çœ‹è®¢å•ï¼š**
```bash
node db-manager.js get 5
```

**æœç´¢è®¢å•ï¼š**
```bash
node db-manager.js search è±†è±†
# æœç´¢ç©å®¶åã€è€æ¿åæˆ–è®¢å•ç±»å‹åŒ…å« "è±†è±†" çš„è®¢å•
```

**å¯¼å‡ºä¸º JSONï¼š**
```bash
node db-manager.js export-json
# ç”Ÿæˆ: backup_2026-01-02.json
```

**å¯¼å‡ºä¸º CSVï¼š**
```bash
node db-manager.js export-csv
# ç”Ÿæˆ: backup_2026-01-02.csv (å¯ç”¨ Excel æ‰“å¼€)
```

**æ¸…ç©ºæ‰€æœ‰è®¢å•ï¼š**
```bash
node db-manager.js clear
# âš ï¸  éœ€è¦ç¡®è®¤
```

**é‡ç½®ç»Ÿè®¡æ•°æ®ï¼š**
```bash
node db-manager.js reset-stats
# âš ï¸  éœ€è¦ç¡®è®¤
```

## ğŸ—‚ï¸ æ•°æ®åº“ç»“æ„

### orders è¡¨ - è®¢å•è¡¨
```
ID          - è®¢å• ID (è‡ªå¢)
type        - è®¢å•ç±»å‹ (report/gift/renew_report/dispatch/renew_dispatch)
boss        - è€æ¿åç§°
player      - é™ªç©è€…åç§°
orderType   - è®¢å•è¯¦ç»†ç±»å‹ (å¦‚ï¼šæ°¸åŠ«ã€åŸç¥ç­‰)
duration    - é™ªç©æ—¶é•¿ (å¦‚ï¼š1å°æ—¶)
amount      - é‡‘é¢ (æ•°å­—)
date        - æ—¥æœŸæ—¶é—´
source      - æ¥æº (reportForm/giftReportForm/dispatchForm ç­‰)
orderNo     - å•å· (å¯é€‰)
createdAt   - åˆ›å»ºæ—¶é—´ (è‡ªåŠ¨)
```

### stats è¡¨ - ç»Ÿè®¡è¡¨
```
id              - ç»Ÿè®¡ ID (å›ºå®šå€¼ 1)
totalOrders     - æ€»è®¢å•æ•°
totalRevenue    - æ€»æ”¶å…¥
lastUpdated     - æœ€åæ›´æ–°æ—¶é—´
```

## ğŸ“Š è®¢å•ç±»å‹è¯´æ˜

| ç±»å‹ | è¯´æ˜ | æ¥æº |
|------|------|------|
| report | å•å­æŠ¥å¤‡ | ç”¨æˆ·æäº¤çš„æŠ¥å¤‡è¡¨å• |
| gift | ç¤¼ç‰©æŠ¥å¤‡ | é€ç¤¼ç‰©æŠ¥å¤‡è¡¨å• |
| renew_report | ç»­å•æŠ¥å¤‡ | ç»­å•æŠ¥å¤‡è¡¨å• |
| dispatch | æ´¾å•è®°å½• | ç®¡ç†å‘˜æ´¾å• |
| renew_dispatch | ç»­å•è®°å½• | ç®¡ç†å‘˜ç»­å• |

## ğŸ”§ ç¼–è¾‘æ•°æ®åº“

### æ–¹å¼ 1ï¼šä½¿ç”¨æ•°æ®åº“ç®¡ç†å·¥å…·å¯¼å‡ºå¹¶ç¼–è¾‘

```bash
# 1. å¯¼å‡ºä¸º JSON
node db-manager.js export-json

# 2. ç”¨ç¼–è¾‘å™¨æ‰“å¼€ç”Ÿæˆçš„ backup_YYYY-MM-DD.json

# 3. ç¼–è¾‘æ•°æ®

# 4. ä¿å­˜åå¯ä»¥æ‰‹åŠ¨å¯¼å…¥ï¼ˆéœ€è¦ä»£ç æ”¯æŒï¼‰
```

### æ–¹å¼ 2ï¼šç¼–ç¨‹æ–¹å¼ç¼–è¾‘

åˆ›å»ºä¸€ä¸ª Node.js è„šæœ¬ (ä¾‹å¦‚ `edit-db.js`)ï¼š

```javascript
const db = require('./db');

(async () => {
  await db.init();
  
  // ç¤ºä¾‹ï¼šæ›´æ–°è®¢å•å•å·
  db.updateOrderNumber(5, 'ORD-001');
  console.log('âœ… è®¢å• 5 çš„å•å·å·²æ›´æ–°ä¸º ORD-001');
  
  // ç¤ºä¾‹ï¼šæŸ¥çœ‹è®¢å•
  const order = db.getOrderById(5);
  console.log('è®¢å•è¯¦æƒ…:', order);
  
  // ç¤ºä¾‹ï¼šè·å–ç»Ÿè®¡æ•°æ®
  const stats = db.getStats();
  console.log('ç»Ÿè®¡æ•°æ®:', stats);
  
  // ç¤ºä¾‹ï¼šæ›´æ–°ç»Ÿè®¡
  db.updateStats(50, 2000);
  console.log('âœ… ç»Ÿè®¡æ•°æ®å·²æ›´æ–°');
  
  db.close();
})();
```

## ğŸ’¡ å¸¸ç”¨æ“ä½œ

### å¿«é€ŸæŸ¥çœ‹ç»Ÿè®¡
```bash
node db-manager.js stats
```

### æŸ¥æ‰¾æŸä¸ªç©å®¶çš„æ‰€æœ‰è®¢å•
```bash
node db-manager.js search ç©å®¶å
```

### å¯¼å‡ºæ•°æ®å¤‡ä»½
```bash
# JSON å¤‡ä»½
node db-manager.js export-json

# CSV å¤‡ä»½ï¼ˆå¯ç”¨ Excel æ‰“å¼€ï¼‰
node db-manager.js export-csv
```

### æŸ¥çœ‹ç‰¹å®šè®¢å•è¯¦æƒ…
```bash
node db-manager.js get 5
# æ˜¾ç¤º ID ä¸º 5 çš„è®¢å•æ‰€æœ‰ä¿¡æ¯
```

## ğŸš¨ å±é™©æ“ä½œ

### è­¦å‘Šï¼šè¿™äº›æ“ä½œä¼šä¿®æ”¹æ•°æ®ï¼

```bash
# æ¸…ç©ºæ‰€æœ‰è®¢å•ï¼ˆéœ€è¦ç¡®è®¤ï¼‰
node db-manager.js clear

# é‡ç½®ç»Ÿè®¡æ•°æ®ï¼ˆéœ€è¦ç¡®è®¤ï¼‰
node db-manager.js reset-stats
```

## ğŸ“ˆ æ€§èƒ½æç¤º

- æ•°æ®åº“æ–‡ä»¶ `data.db` æ˜¯äºŒè¿›åˆ¶ SQLite æ–‡ä»¶
- ä¸è¦æ‰‹åŠ¨ç¼–è¾‘ `data.db`ï¼Œä½¿ç”¨æœ¬å·¥å…·
- å®šæœŸå¤‡ä»½ï¼š`node db-manager.js export-json`
- æ•°æ®åº“è‡ªåŠ¨ä¿å­˜æ¯ä¸ªæ“ä½œ

## ğŸ” å¤‡ä»½å»ºè®®

```bash
# æ¯å‘¨å¯¼å‡ºå¤‡ä»½
node db-manager.js export-json
node db-manager.js export-csv

# ä¿å­˜åˆ°å¤–éƒ¨ä½ç½®
cp backup_*.json /path/to/backup/
cp backup_*.csv /path/to/backup/
```

## ğŸ“ æ—¥å¿—è®°å½•

æ‰€æœ‰æ•°æ®åº“æ“ä½œéƒ½ä¼šè¾“å‡ºæ—¥å¿—ï¼š
- âœ… æˆåŠŸæ“ä½œ
- âŒ å¤±è´¥æ“ä½œ
- âš ï¸ è­¦å‘Šä¿¡æ¯

## ğŸ†˜ æ•…éšœæ’é™¤

### é—®é¢˜ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶
ls -la data.db

# é‡æ–°åˆå§‹åŒ–ï¼ˆåˆ é™¤å¹¶é‡å»ºï¼‰
rm data.db
node migrate.js
```

### é—®é¢˜ï¼šæ“ä½œåçœ‹ä¸åˆ°å˜åŒ–
```bash
# æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
node db-info.js

# æŸ¥çœ‹å®Œæ•´è®¢å•åˆ—è¡¨
node db-manager.js view
```

### é—®é¢˜ï¼šéœ€è¦æ¢å¤æ•°æ®
```bash
# ä½¿ç”¨ä¹‹å‰å¯¼å‡ºçš„ JSON å¤‡ä»½
# è”ç³»ç®¡ç†å‘˜æ¢å¤
```

---

**æç¤º**ï¼šæ‰€æœ‰æŸ¥è¯¢æ“ä½œéƒ½ä¸ä¼šä¿®æ”¹æ•°æ®ï¼Œå¯ä»¥å®‰å…¨ä½¿ç”¨ï¼ âœ…
